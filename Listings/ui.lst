C51 COMPILER V9.54   UI                                                                    01/10/2018 14:56:36 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE UI
OBJECT MODULE PLACED IN .\Objects\ui.obj
COMPILER INVOKED BY: D:\Program Files (x86)\KeiluVision\C51\C51\BIN\C51.EXE ui.c OPTIMIZE(9,SPEED) BROWSE DEBUG OBJECTEX
                    -TEND PRINT(.\Listings\ui.lst) OBJECT(.\Objects\ui.obj)

line level    source

   1          #include "stdafx.h"
   2          //code by </MATRIX>@Neod Anderjon
   3          //==========================================================================
   4          //LCD1602 UI界面
   5          
   6          //LCD1602显示字符串
   7          u8 code MotorStatus[]   = "MS:";                                //显示电机状态
   8          u8 code Start[]                 = "Work";                               //起始转动显示
   9          u8 code Stop[]                  = "Stew";                               //停止转动显示
  10          u8 code Direction[]     = "DIR:";                               //显示转动方向
  11          u8 code Postive[]               = "Pos";                                //正转
  12          u8 code Negative[]              = "Neg";                                //反转
  13          u8 code RotationAngle[] = "RA:";                                //转动角度
  14          u8 code RotationMeter[] = "RM:";                                //转动行程
  15          u8 code RotationSpeed[] = "RS:";                                //转动速度
  16          //Logo & UI
  17          u8 code WkverLogo[]     = "T.WKVER";
  18          u8 code MinusSymbol16[] = "--------------->";   //特效线
  19          u8 code MatrixLogo[]    = "</MATRIX>";
  20          u8 code codeBy[]                = "Code By";
  21          u8 code ArthorName[]    = "Neod Anderjon";
  22          u8 code ProjectLogo[]   = "StepMotorControl";
  23          
  24          //显示logo屏内容
  25          void LCD1602DisplayLogo (void)
  26          {
  27   1              LCD1602_ClearScreen();
  28   1              lcd_es = dis_logo;
  29   1              LCD1602_DisplayString(5, ROW1, WkverLogo);
  30   1              LCD1602_DisplayString(0, ROW2, ProjectLogo);
  31   1              delay_ms(500);
  32   1              LCD1602_ClearScreen();
  33   1              LCD1602_DisplayString(4, ROW1, MatrixLogo);
  34   1              delay_ms(500);
  35   1              LCD1602_ClearScreen();
  36   1              LCD1602_DisplayString(0, ROW1, codeBy);
  37   1              LCD1602_DisplayString(3, ROW2, ArthorName);
  38   1      }
  39          
  40          //显示status屏内容
  41          void LCD1602DisplayStatus (void)
  42          {
  43   1              LCD1602_ClearScreen();
  44   1              lcd_es = dis_status;
  45   1              //显示电机状态，默认停止
  46   1              LCD1602_DisplayString(0, ROW1, MotorStatus);
  47   1              LCD1602_DisplayString(3, ROW1, Stop);
  48   1              //显示方向，默认正转
  49   1              LCD1602_DisplayString(9, ROW1, Direction);
  50   1              LCD1602_DisplayString(13, ROW1, Postive);
  51   1              //显示转速和转动角度
  52   1              switch (lrs_flag)
  53   1              {
  54   2              case LineUnit:  LCD1602_DisplayString(0, ROW2, RotationMeter); break;
C51 COMPILER V9.54   UI                                                                    01/10/2018 14:56:36 PAGE 2   

  55   2              case RadUnit:   LCD1602_DisplayString(0, ROW2, RotationAngle); break;
  56   2              }
  57   1              LCD1602_DisplayNumber(3, RotationDistance, ROW2);
  58   1              LCD1602_DisplayString(9, ROW2, RotationSpeed);
  59   1              LCD1602_DisplayNumber(12, SettingSpeedHz, ROW2);
  60   1      }
  61          
  62          //滑动logo
  63          void LCD1602DisplaySlideLogo (void)
  64          {
  65   1              uint8_t i;
  66   1              
  67   1              LCD1602_ClearScreen();
  68   1              lcd_es = dis_slide;
  69   1              while (True)
  70   1              {
  71   2                      for (i = 0; i < 16; i++)
  72   2                      {
  73   3                              LCD1602_DisplayString(0, ROW1, MinusSymbol16);
  74   3                              LCD1602_DisplayString(i, ROW1, WkverLogo);
  75   3                              LCD1602_DisplayString(0, ROW2, ProjectLogo);
  76   3                              delay_ms(500);
  77   3                              if (gdv != rplay) break;        //退出显示循环
  78   3                      }
  79   2                      if (gdv != rplay) break;                //退出显示循环
  80   2              }
  81   1      }
  82          
  83          //对输入变量限定取值
  84          void LCD1602DisplayUpdate (void)
  85          {
  86   1              //转动角度数值显示限位
  87   1              if (RotationDistance <= 0) RotationDistance = 0;
  88   1              else if (RotationDistance > 9999) RotationDistance = 0;
  89   1              //转速计算限制
  90   1              if (SettingSpeedHz <= 0) SettingSpeedHz = 0;
  91   1              else if (SettingSpeedHz > 4000) SettingSpeedHz = 0;             
  92   1              
  93   1              if (lcd_es == dis_status)
  94   1              {
  95   2                      //更新电机运行状态
  96   2                      if (MotorStatusFlag == Stew)
  97   2                              LCD1602_DisplayString(3, ROW1, Stop);
  98   2                      else
  99   2                              LCD1602_DisplayString(3, ROW1, Start);
 100   2                      //更新方向
 101   2                      if (IO_Direction == posrot)
 102   2                              LCD1602_DisplayString(13, ROW1, Postive);
 103   2                      else 
 104   2                              LCD1602_DisplayString(13, ROW1, Negative);
 105   2                      //更新变量
 106   2                      LCD1602_DisplayNumber(3, RotationDistance, ROW2);
 107   2                      LCD1602_DisplayNumber(12, SettingSpeedHz, ROW2);
 108   2              }               
 109   1      }
 110          
 111          //==========================================================================
 112          //code by </MATRIX>@Neod Anderjon


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    409    ----
C51 COMPILER V9.54   UI                                                                    01/10/2018 14:56:36 PAGE 3   

   CONSTANT SIZE    =    113    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
