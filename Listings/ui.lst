C51 COMPILER V9.54   UI                                                                    01/10/2018 11:39:42 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE UI
OBJECT MODULE PLACED IN .\Objects\ui.obj
COMPILER INVOKED BY: D:\Program Files (x86)\KeiluVision\C51\C51\BIN\C51.EXE ui.c OPTIMIZE(9,SPEED) BROWSE DEBUG OBJECTEX
                    -TEND PRINT(.\Listings\ui.lst) OBJECT(.\Objects\ui.obj)

line level    source

   1          #include "stdafx.h"
   2          //code by </MATRIX>@Neod Anderjon
   3          //==========================================================================
   4          //LCD1602 UI界面
   5          
   6          //LCD1602显示字符串
   7          u8 code MotorStatus[]   = "MS:";                                //显示电机状态
   8          u8 code Start[]                 = "Work";                               //起始转动显示
   9          u8 code Stop[]                  = "Stew";                               //停止转动显示
  10          u8 code Direction[]     = "DIR:";                               //显示转动方向
  11          u8 code Postive[]               = "Pos";                                //正转
  12          u8 code Negative[]              = "Neg";                                //反转
  13          u8 code RotationAngle[] = "RA:";                                //转动角度
  14          u8 code RotationMeter[] = "RM:";                                //转动行程
  15          u8 code RotationSpeed[] = "RS:";                                //转动速度
  16          //Logo & UI
  17          u8 code WkverLogo[]     = "T.WKVER";
  18          u8 code MinusSymbol16[] = "--------------->";   //特效线
  19          u8 code MatrixLogo[]    = "</MATRIX>";
  20          u8 code codeBy[]                = "Code By";
  21          u8 code ArthorName[]    = "Neod Anderjon";
  22          u8 code ProjectLogo[]   = "StepMotorControl";
  23          
  24          //显示logo屏内容
  25          void LCD1602DisplayLogo (void)
  26          {
  27   1              LCD1602_ClearScreen();
  28   1              lcd_es = dis_logo;
  29   1              LCD1602_DisplayString(5, ROW1, WkverLogo);
  30   1              LCD1602_DisplayString(0, ROW2, ProjectLogo);
  31   1              delay_ms(500);
  32   1              LCD1602_ClearScreen();
  33   1              LCD1602_DisplayString(4, ROW1, MatrixLogo);
  34   1              delay_ms(500);
  35   1              LCD1602_ClearScreen();
  36   1              LCD1602_DisplayString(0, ROW1, codeBy);
  37   1              LCD1602_DisplayString(3, ROW2, ArthorName);
  38   1      }
  39          
  40          //显示status屏内容
  41          void LCD1602DisplayStatus (void)
  42          {
  43   1              LCD1602_ClearScreen();
  44   1              lcd_es = dis_status;
  45   1              //显示电机状态，默认停止
  46   1              LCD1602_DisplayString(0, ROW1, MotorStatus);
  47   1              LCD1602_DisplayString(3, ROW1, Stop);
  48   1              //显示方向，默认正转
  49   1              LCD1602_DisplayString(9, ROW1, Direction);
  50   1              LCD1602_DisplayString(13, ROW1, Postive);
  51   1              //显示转速和转动角度
  52   1              LCD1602_DisplayString(0, ROW2, RotationAngle);
  53   1              LCD1602_DisplayNumber(3, RotationDistance, ROW2);
  54   1              LCD1602_DisplayString(9, ROW2, RotationSpeed);
C51 COMPILER V9.54   UI                                                                    01/10/2018 11:39:42 PAGE 2   

  55   1              LCD1602_DisplayNumber(12, SettingSpeedHz, ROW2);
  56   1      }
  57          
  58          //滑动logo
  59          void LCD1602DisplaySlideLogo (void)
  60          {
  61   1              uint8_t i;
  62   1              
  63   1              LCD1602_ClearScreen();
  64   1              lcd_es = dis_slide;
  65   1              while (True)
  66   1              {
  67   2                      for (i = 0; i < 16; i++)
  68   2                      {
  69   3                              LCD1602_DisplayString(0, ROW1, MinusSymbol16);
  70   3                              LCD1602_DisplayString(i, ROW1, WkverLogo);
  71   3                              LCD1602_DisplayString(0, ROW2, ProjectLogo);
  72   3                              delay_ms(500);
  73   3                              if (gdv != rplay) break;        //退出显示循环
  74   3                      }
  75   2                      if (gdv != rplay) break;                //退出显示循环
  76   2              }
  77   1      }
  78          
  79          //对输入变量限定取值
  80          void LCD1602DisplayUpdate (void)
  81          {
  82   1              //转动角度数值显示限位
  83   1              if (RotationDistance <= 0) RotationDistance = 0;
  84   1              else if (RotationDistance > 9999) RotationDistance = 0;
  85   1              //转速计算限制
  86   1              if (SettingSpeedHz <= 0) SettingSpeedHz = 0;
  87   1              else if (SettingSpeedHz > 4000) SettingSpeedHz = 0;             
  88   1              
  89   1              if (lcd_es == dis_status)
  90   1              {
  91   2                      //更新电机运行状态
  92   2                      if (MotorStatusFlag == Stew)
  93   2                              LCD1602_DisplayString(3, ROW1, Stop);
  94   2                      else
  95   2                              LCD1602_DisplayString(3, ROW1, Start);
  96   2                      //更新方向
  97   2                      if (IO_Direction == posrot)
  98   2                              LCD1602_DisplayString(13, ROW1, Postive);
  99   2                      else 
 100   2                              LCD1602_DisplayString(13, ROW1, Negative);
 101   2                      //更新变量
 102   2                      LCD1602_DisplayNumber(3, RotationDistance, ROW2);
 103   2                      LCD1602_DisplayNumber(12, SettingSpeedHz, ROW2);
 104   2              }               
 105   1      }
 106          
 107          //==========================================================================
 108          //code by </MATRIX>@Neod Anderjon


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    391    ----
   CONSTANT SIZE    =    113    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       1
C51 COMPILER V9.54   UI                                                                    01/10/2018 11:39:42 PAGE 3   

   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
